# The project
This project provides a GUI app to run the Gross-Pitaevskii equation for Bose-Einstein condensates.
It assumes a 3D harmonic potential. The user can select grid and potential parameters and even imprint vortices in real time.
For this to work, the assumption is that the BEC is confined in the z-axis leading to a disk-shaped 2D BEC.

Currently only vortex-type excitations are supported. These are assumed to be printed directly on the condensate using a phase manipulation technique.

# How to Run
Simply run the .exe application. Then select the parameters in the pop-up window. Start and stop the simulation by clicking on the
respective buttons.

Note that since this only runs on CPU, if the grid is too big e.g. more than 256x256x16, it will take wuite some time for the simulation
and you'll be seeing it lagging.

# Code structure
## Simulation.go
SimParams Struct: Defines the data structure to hold configuration values
PlotData:
    Time: Transmits the current simulation time for display.
    
    DensitySlice, PhaseSlice: Contain the actual 2D data arrays ([][]float64) for the density and phase plots. These are generated by the simulation's slicing functions.

    Extent: Provides the [xmin, xmax, ymin, ymax] values needed by the plotting logic to correctly map data indices to spatial coordinates on the plot axes.

    SliceAxis: Records which dimension ('x', 'y', or 'z') was sliced to produce this data. Currently used implicitly (always 'z'), but useful for future extensions.

    Error: If the simulation encounters an error (e.g., numerical instability, failure during a step), it can send a PlotData struct with this field set. The GUI update loop checks this field first and displays the error instead of attempting to plot potentially invalid data.

ControlMsg:

    Command: A string identifier for the action requested by the GUI (e.g., "start", "stop", "reset", "update_g", "imprint"). The simulation's handleControlMessage function uses a switch statement on this field to handle each scenario.

    GValue: Used to send the updated value from the 'g' slider when the command is "update_g". It's also conveniently used by the reset button callback to tell the simulation what value 'g' should be reset to (matching the current slider position).

    Vortex: Embeds the VortexInfo struct (which contains X0, Y0, Charge) when the command is "imprint". This packages all necessary information for the vortex imprinting action.
    
GPE3DSimulation:

    Contains all necessary fields: parameters (params), constants (hbar, m), calculated grid info (dx, dy, ...), grid arrays (x, y, z, kx, ..., psi, potentialV, expK), simulation state (time, dt, gVal, running, vortices), communication (updateChan, controlChan), and control (mu, ctx, cancel, wg).

    Arrays are declared as 3D slices ([][][]).

NewSimulation Constructor():

    Performs basic validation on input parameters.
    Initializes the struct fields with constants, defaults, and passed-in channels/parameters.
    Calls helper methods (createGrids, calculatePotential, initialState, precomputeExpK) to perform the bulk of the setup work.

createGrids Method:

    Calculates grid spacings (dx, dy, dz) and volume element (dv).
    Fills the real-space coordinate grids (x, y, z).
    Calculates the corresponding k-space vectors based on FFT frequency conventions and fills kx, ky, kz, and kSq.

calculatePotential Method:

    creates the potential array

initialState Method:

    Calculates the anisotropic Gaussian widths (sigmaX, sigmaY, sigmaZ) based on the potential frequencies (omegaX, ...), handling the omega=0 case.
    Normalizes the wavefunction by dividing each element by the calculated norm.

precomputeExpK Method:

    Calculates the complex kinetic evolution factor exp(-0.5i * hbar/m * kSq * dt) for each point in k-space using the pre-calculated sim.kSq grid.


kineticStep:

    uses FFT and IFFT

step:

    Implements the Strang splitting formula: Potential(dt/2) * Kinetic(dt) * Potential(dt/2).

Run:

    The core loop of the simulation goroutine.
        Uses a non-blocking select to send the PlotData on sim.updateChan. If the channel is full (GUI is lagging), it logs a warning and drops the frame instead of blocking the simulation loop.

handleControlMessage:

    Contains the logic for reacting to start, stop, reset, update_g, and imprint commands.

imprintVortex:

    Takes the vortex center coordinates (x0, y0) and charge as input. Creates the phase 

## Gui.go
Buttons send "start", "stop", or "reset" commands via controlChan. The reset button also updates the GUI immediately.

guiUpdateLoop:

    Runs continuously in a separate goroutine.

    Ranges over the updateChan, blocking until data arrives or the channel is closed.

    If an error is received in PlotData, it shows an error dialog.
